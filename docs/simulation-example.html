<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.9 Simulation Example | Experiments and Causality</title>
  <meta name="description" content="This is the live-session notebook for class discussion for the UC Berkeley School of Information, Masters in Data Science course called Experiments and Causality." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="2.9 Simulation Example | Experiments and Causality" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/images/coffee.jpeg" />
  <meta property="og:description" content="This is the live-session notebook for class discussion for the UC Berkeley School of Information, Masters in Data Science course called Experiments and Causality." />
  <meta name="github-repo" content="UC-Berkeley-I-School/mids-w241-live-session" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.9 Simulation Example | Experiments and Causality" />
  
  <meta name="twitter:description" content="This is the live-session notebook for class discussion for the UC Berkeley School of Information, Masters in Data Science course called Experiments and Causality." />
  <meta name="twitter:image" content="/images/coffee.jpeg" />

<meta name="author" content="David Reiley, David Broockman, D. Alex Hughes, \ Micah Gell-Redman, Scott Guenther, \ David Wheeler &amp; Conor Healy \ Chris Donaton &amp; Kineret Stanley" />


<meta name="date" content="2022-02-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="theoretical-justification.html"/>
<link rel="next" href="requirements-of-an-experiment.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Live Session Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="blooms-taxonomy.html"><a href="blooms-taxonomy.html"><i class="fa fa-check"></i>Bloom’s Taxonomy</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="importance-of-experimentation.html"><a href="importance-of-experimentation.html"><i class="fa fa-check"></i><b>1</b> Importance of Experimentation</a>
<ul>
<li class="chapter" data-level="1.1" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>1.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="1.2" data-path="class-introductions.html"><a href="class-introductions.html"><i class="fa fa-check"></i><b>1.2</b> Class Introductions</a></li>
<li class="chapter" data-level="1.3" data-path="course-plan.html"><a href="course-plan.html"><i class="fa fa-check"></i><b>1.3</b> Course Plan</a></li>
<li class="chapter" data-level="1.4" data-path="course-logistics.html"><a href="course-logistics.html"><i class="fa fa-check"></i><b>1.4</b> Course Logistics</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="course-logistics.html"><a href="course-logistics.html#learning-model-for-the-class"><i class="fa fa-check"></i><b>1.4.1</b> Learning model for the class</a></li>
<li class="chapter" data-level="1.4.2" data-path="course-logistics.html"><a href="course-logistics.html#feedback-model-for-the-class"><i class="fa fa-check"></i><b>1.4.2</b> Feedback model for the class</a></li>
<li class="chapter" data-level="1.4.3" data-path="course-logistics.html"><a href="course-logistics.html#office-hour-model-for-the-class"><i class="fa fa-check"></i><b>1.4.3</b> Office hour model for the class</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="article-discussion.html"><a href="article-discussion.html"><i class="fa fa-check"></i><b>1.5</b> Article Discussion</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="article-discussion.html"><a href="article-discussion.html#predict-or-cause"><i class="fa fa-check"></i><b>1.5.1</b> Predict or Cause</a></li>
<li class="chapter" data-level="1.5.2" data-path="article-discussion.html"><a href="article-discussion.html#do-the-suburbs-make-you-fat"><i class="fa fa-check"></i><b>1.5.2</b> Do the suburbs make you fat?</a></li>
<li class="chapter" data-level="1.5.3" data-path="article-discussion.html"><a href="article-discussion.html#nike-shoes"><i class="fa fa-check"></i><b>1.5.3</b> Nike Shoes</a></li>
<li class="chapter" data-level="1.5.4" data-path="article-discussion.html"><a href="article-discussion.html#what-is-science-feynmans-view"><i class="fa fa-check"></i><b>1.5.4</b> What is Science: Feynman’s View</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="apples-to-apples.html"><a href="apples-to-apples.html"><i class="fa fa-check"></i><b>2</b> Apples to Apples</a>
<ul>
<li class="chapter" data-level="2.1" data-path="learning-objectives-1.html"><a href="learning-objectives-1.html"><i class="fa fa-check"></i><b>2.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.2" data-path="revisiting-ideas-of-science.html"><a href="revisiting-ideas-of-science.html"><i class="fa fa-check"></i><b>2.2</b> Revisiting Ideas of Science</a></li>
<li class="chapter" data-level="2.3" data-path="this-causes-that.html"><a href="this-causes-that.html"><i class="fa fa-check"></i><b>2.3</b> This Causes That</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="this-causes-that.html"><a href="this-causes-that.html#damn-fine-coffee"><i class="fa fa-check"></i><b>2.3.1</b> Damn fine coffee</a></li>
<li class="chapter" data-level="2.3.2" data-path="this-causes-that.html"><a href="this-causes-that.html#meditation-for-focus"><i class="fa fa-check"></i><b>2.3.2</b> Meditation for focus</a></li>
<li class="chapter" data-level="2.3.3" data-path="this-causes-that.html"><a href="this-causes-that.html#selling-coffee-and-meditation"><i class="fa fa-check"></i><b>2.3.3</b> Selling coffee and meditation</a></li>
<li class="chapter" data-level="2.3.4" data-path="this-causes-that.html"><a href="this-causes-that.html#limits-of-behaviorist-reasoning"><i class="fa fa-check"></i><b>2.3.4</b> Limits of Behaviorist Reasoning</a></li>
<li class="chapter" data-level="2.3.5" data-path="this-causes-that.html"><a href="this-causes-that.html#reflecting-on-causes"><i class="fa fa-check"></i><b>2.3.5</b> Reflecting on Causes</a></li>
<li class="chapter" data-level="2.3.6" data-path="this-causes-that.html"><a href="this-causes-that.html#evaluating-value"><i class="fa fa-check"></i><b>2.3.6</b> Evaluating Value</a></li>
<li class="chapter" data-level="2.3.7" data-path="this-causes-that.html"><a href="this-causes-that.html#value-of-theory"><i class="fa fa-check"></i><b>2.3.7</b> Value of Theory</a></li>
<li class="chapter" data-level="2.3.8" data-path="this-causes-that.html"><a href="this-causes-that.html#evaluating-theories"><i class="fa fa-check"></i><b>2.3.8</b> Evaluating Theories</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="reading-discussion-the-power-of-experiments.html"><a href="reading-discussion-the-power-of-experiments.html"><i class="fa fa-check"></i><b>2.4</b> Reading Discussion: The Power of Experiments</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="reading-discussion-the-power-of-experiments.html"><a href="reading-discussion-the-power-of-experiments.html#chapter-one-the-power-of-experiments"><i class="fa fa-check"></i><b>2.4.1</b> Chapter One: The Power of Experiments</a></li>
<li class="chapter" data-level="2.4.2" data-path="reading-discussion-the-power-of-experiments.html"><a href="reading-discussion-the-power-of-experiments.html#chapter-two-the-rise-of-experimetnts-in-psychology-and-economics"><i class="fa fa-check"></i><b>2.4.2</b> Chapter Two: The Rise of Experimetnts in Psychology and Economics</a></li>
<li class="chapter" data-level="2.4.3" data-path="reading-discussion-the-power-of-experiments.html"><a href="reading-discussion-the-power-of-experiments.html#the-rise-of-behavioral-experiments-in-policymaking"><i class="fa fa-check"></i><b>2.4.3</b> The Rise of Behavioral Experiments in Policymaking</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="potential-outcomes.html"><a href="potential-outcomes.html"><i class="fa fa-check"></i><b>2.5</b> Potential Outcomes</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="potential-outcomes.html"><a href="potential-outcomes.html#defining-potential-outcomes"><i class="fa fa-check"></i><b>2.5.1</b> Defining Potential Outcomes</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="using-independence.html"><a href="using-independence.html"><i class="fa fa-check"></i><b>2.6</b> Using Independence</a></li>
<li class="chapter" data-level="2.7" data-path="use-randomization-to-produce-independence.html"><a href="use-randomization-to-produce-independence.html"><i class="fa fa-check"></i><b>2.7</b> Use Randomization to Produce Independence</a></li>
<li class="chapter" data-level="2.8" data-path="theoretical-justification.html"><a href="theoretical-justification.html"><i class="fa fa-check"></i><b>2.8</b> Theoretical Justification</a></li>
<li class="chapter" data-level="2.9" data-path="simulation-example.html"><a href="simulation-example.html"><i class="fa fa-check"></i><b>2.9</b> Simulation Example</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="simulation-example.html"><a href="simulation-example.html#assign-to-treatment-and-control"><i class="fa fa-check"></i><b>2.9.1</b> Assign to Treatment and Control</a></li>
<li class="chapter" data-level="2.9.2" data-path="simulation-example.html"><a href="simulation-example.html#what-if-there-is-selection"><i class="fa fa-check"></i><b>2.9.2</b> What if there is selection?</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="requirements-of-an-experiment.html"><a href="requirements-of-an-experiment.html"><i class="fa fa-check"></i><b>2.10</b> Requirements of An Experiment</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="requirements-of-an-experiment.html"><a href="requirements-of-an-experiment.html#meta-questions"><i class="fa fa-check"></i><b>2.10.1</b> Meta-Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="quantifying-uncertainty.html"><a href="quantifying-uncertainty.html"><i class="fa fa-check"></i><b>3</b> Quantifying Uncertainty</a>
<ul>
<li class="chapter" data-level="3.1" data-path="learning-objectives-2.html"><a href="learning-objectives-2.html"><i class="fa fa-check"></i><b>3.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="3.2" data-path="power-of-experiments.html"><a href="power-of-experiments.html"><i class="fa fa-check"></i><b>3.2</b> Power of Experiments</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="power-of-experiments.html"><a href="power-of-experiments.html#five-key-barriers-to-experimentation"><i class="fa fa-check"></i><b>3.2.1</b> Five Key Barriers to Experimentation</a></li>
<li class="chapter" data-level="3.2.2" data-path="power-of-experiments.html"><a href="power-of-experiments.html#experimental-ethics"><i class="fa fa-check"></i><b>3.2.2</b> Experimental Ethics</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="statistical-uncertainty-randomization-inference-style.html"><a href="statistical-uncertainty-randomization-inference-style.html"><i class="fa fa-check"></i><b>3.3</b> Statistical Uncertainty – Randomization Inference Style</a></li>
<li class="chapter" data-level="3.4" data-path="stating-the-sharp-null.html"><a href="stating-the-sharp-null.html"><i class="fa fa-check"></i><b>3.4</b> Stating the sharp null</a></li>
<li class="chapter" data-level="3.5" data-path="randomization-inference.html"><a href="randomization-inference.html"><i class="fa fa-check"></i><b>3.5</b> Randomization Inference</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="randomization-inference.html"><a href="randomization-inference.html#stating-the-process-of-randomization-inference"><i class="fa fa-check"></i><b>3.5.1</b> Stating the process of Randomization Inference</a></li>
<li class="chapter" data-level="3.5.2" data-path="randomization-inference.html"><a href="randomization-inference.html#questions-about-randomization-inference"><i class="fa fa-check"></i><b>3.5.2</b> Questions about Randomization Inference</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="applying-randomization-inference.html"><a href="applying-randomization-inference.html"><i class="fa fa-check"></i><b>3.6</b> Applying Randomization Inference</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="applying-randomization-inference.html"><a href="applying-randomization-inference.html#make-data"><i class="fa fa-check"></i><b>3.6.1</b> Make Data</a></li>
<li class="chapter" data-level="3.6.2" data-path="applying-randomization-inference.html"><a href="applying-randomization-inference.html#plot-data"><i class="fa fa-check"></i><b>3.6.2</b> Plot Data</a></li>
<li class="chapter" data-level="3.6.3" data-path="applying-randomization-inference.html"><a href="applying-randomization-inference.html#classic-test"><i class="fa fa-check"></i><b>3.6.3</b> Classic Test</a></li>
<li class="chapter" data-level="3.6.4" data-path="applying-randomization-inference.html"><a href="applying-randomization-inference.html#randomization-inference-test"><i class="fa fa-check"></i><b>3.6.4</b> Randomization Inference Test</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="comparing-randomization-inference-and-frequentist-inference.html"><a href="comparing-randomization-inference-and-frequentist-inference.html"><i class="fa fa-check"></i><b>3.7</b> Comparing Randomization Inference and Frequentist Inference</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="comparing-randomization-inference-and-frequentist-inference.html"><a href="comparing-randomization-inference-and-frequentist-inference.html#donations-to-a-political-campaign"><i class="fa fa-check"></i><b>3.7.1</b> Donations to a political campaign</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="statistical-power.html"><a href="statistical-power.html"><i class="fa fa-check"></i><b>3.8</b> Statistical Power</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="blocking-and-clustering.html"><a href="blocking-and-clustering.html"><i class="fa fa-check"></i><b>4</b> Blocking and Clustering</a>
<ul>
<li class="chapter" data-level="4.1" data-path="learning-objectives-3.html"><a href="learning-objectives-3.html"><i class="fa fa-check"></i><b>4.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="4.2" data-path="setting-terms-blocking.html"><a href="setting-terms-blocking.html"><i class="fa fa-check"></i><b>4.2</b> Setting terms: Blocking</a></li>
<li class="chapter" data-level="4.3" data-path="math-block-random-assignment.html"><a href="math-block-random-assignment.html"><i class="fa fa-check"></i><b>4.3</b> Math: Block random assignment</a></li>
<li class="chapter" data-level="4.4" data-path="intuition-block-random-assignment.html"><a href="intuition-block-random-assignment.html"><i class="fa fa-check"></i><b>4.4</b> Intuition: Block Random Assignment</a></li>
<li class="chapter" data-level="4.5" data-path="with-this-data-what-does-the-distribution-of-outcomes-look-like.html"><a href="with-this-data-what-does-the-distribution-of-outcomes-look-like.html"><i class="fa fa-check"></i><b>4.5</b> With this data, what does the distribution of outcomes look like?</a></li>
<li class="chapter" data-level="4.6" data-path="technical-benefits-of-blocking.html"><a href="technical-benefits-of-blocking.html"><i class="fa fa-check"></i><b>4.6</b> Technical Benefits of Blocking</a></li>
<li class="chapter" data-level="4.7" data-path="how-should-we-block-randomize.html"><a href="how-should-we-block-randomize.html"><i class="fa fa-check"></i><b>4.7</b> How should we block randomize?</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="how-should-we-block-randomize.html"><a href="how-should-we-block-randomize.html#what-makes-a-useful-feature-part-1"><i class="fa fa-check"></i><b>4.7.1</b> What makes a useful feature? (part 1)</a></li>
<li class="chapter" data-level="4.7.2" data-path="how-should-we-block-randomize.html"><a href="how-should-we-block-randomize.html#what-makes-a-useful-feature-part-2"><i class="fa fa-check"></i><b>4.7.2</b> What makes a useful feature (part 2)</a></li>
<li class="chapter" data-level="4.7.3" data-path="how-should-we-block-randomize.html"><a href="how-should-we-block-randomize.html#strategies-of-blocking"><i class="fa fa-check"></i><b>4.7.3</b> Strategies of blocking</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>4.8</b> Clustering</a></li>
<li class="chapter" data-level="4.9" data-path="blocking-or-clustering.html"><a href="blocking-or-clustering.html"><i class="fa fa-check"></i><b>4.9</b> Blocking or Clustering?</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="blocking-or-clustering.html"><a href="blocking-or-clustering.html#let-is-snow"><i class="fa fa-check"></i><b>4.9.1</b> Let is snow!</a></li>
<li class="chapter" data-level="4.9.2" data-path="blocking-or-clustering.html"><a href="blocking-or-clustering.html#strolling-through-berkeley"><i class="fa fa-check"></i><b>4.9.2</b> Strolling through Berkeley</a></li>
<li class="chapter" data-level="4.9.3" data-path="blocking-or-clustering.html"><a href="blocking-or-clustering.html#always-low-prices"><i class="fa fa-check"></i><b>4.9.3</b> Always low prices?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="covariates-and-regression.html"><a href="covariates-and-regression.html"><i class="fa fa-check"></i><b>5</b> Covariates and Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="learning-objectives-4.html"><a href="learning-objectives-4.html"><i class="fa fa-check"></i><b>5.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="5.2" data-path="covariates.html"><a href="covariates.html"><i class="fa fa-check"></i><b>5.2</b> Covariates</a></li>
<li class="chapter" data-level="5.3" data-path="rescaling-outcomes.html"><a href="rescaling-outcomes.html"><i class="fa fa-check"></i><b>5.3</b> Rescaling Outcomes</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="rescaling-outcomes.html"><a href="rescaling-outcomes.html#design-one-two-group-post-test"><i class="fa fa-check"></i><b>5.3.1</b> Design One: Two Group Post-Test</a></li>
<li class="chapter" data-level="5.3.2" data-path="rescaling-outcomes.html"><a href="rescaling-outcomes.html#design-two-one-group-pre-test-post-test"><i class="fa fa-check"></i><b>5.3.2</b> Design Two: One Group, Pre-test Post-test</a></li>
<li class="chapter" data-level="5.3.3" data-path="rescaling-outcomes.html"><a href="rescaling-outcomes.html#evaluate-the-strengths-of-the-two-designs"><i class="fa fa-check"></i><b>5.3.3</b> Evaluate the strengths of the two designs</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="combining-designs.html"><a href="combining-designs.html"><i class="fa fa-check"></i><b>5.4</b> Combining Designs?</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="combining-designs.html"><a href="combining-designs.html#design-three-two-group-pre-test-post-test"><i class="fa fa-check"></i><b>5.4.1</b> Design Three: Two Group, Pre-test Post-test</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="working-with-simple-data.html"><a href="working-with-simple-data.html"><i class="fa fa-check"></i><b>5.5</b> Working with simple data</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="working-with-simple-data.html"><a href="working-with-simple-data.html#without-blocking"><i class="fa fa-check"></i><b>5.5.1</b> Without blocking</a></li>
<li class="chapter" data-level="5.5.2" data-path="working-with-simple-data.html"><a href="working-with-simple-data.html#with-blocking"><i class="fa fa-check"></i><b>5.5.2</b> With blocking</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="regression-and-multifactor-experiments.html"><a href="regression-and-multifactor-experiments.html"><i class="fa fa-check"></i><b>6</b> Regression and Multifactor Experiments</a>
<ul>
<li class="chapter" data-level="6.1" data-path="learning-objectives-5.html"><a href="learning-objectives-5.html"><i class="fa fa-check"></i><b>6.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="6.2" data-path="good-controls.html"><a href="good-controls.html"><i class="fa fa-check"></i><b>6.2</b> Good Controls</a></li>
<li class="chapter" data-level="6.3" data-path="bad-controls.html"><a href="bad-controls.html"><i class="fa fa-check"></i><b>6.3</b> Bad Controls</a></li>
<li class="chapter" data-level="6.4" data-path="a-very-simple-example.html"><a href="a-very-simple-example.html"><i class="fa fa-check"></i><b>6.4</b> A Very Simple Example</a></li>
<li class="chapter" data-level="6.5" data-path="make-data-1.html"><a href="make-data-1.html"><i class="fa fa-check"></i><b>6.5</b> Make Data</a></li>
<li class="chapter" data-level="6.6" data-path="what-is-the-causal-model-we-hold.html"><a href="what-is-the-causal-model-we-hold.html"><i class="fa fa-check"></i><b>6.6</b> What is the causal model we hold?</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="what-is-the-causal-model-we-hold.html"><a href="what-is-the-causal-model-we-hold.html#do-the-estimates-match-the-world"><i class="fa fa-check"></i><b>6.6.1</b> Do the estimates match the world?</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="a-more-complicated-example.html"><a href="a-more-complicated-example.html"><i class="fa fa-check"></i><b>6.7</b> A More Complicated Example</a></li>
<li class="chapter" data-level="6.8" data-path="look-at-data.html"><a href="look-at-data.html"><i class="fa fa-check"></i><b>6.8</b> Look at Data</a></li>
<li class="chapter" data-level="6.9" data-path="estimate-relationships.html"><a href="estimate-relationships.html"><i class="fa fa-check"></i><b>6.9</b> Estimate Relationships</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="estimate-relationships.html"><a href="estimate-relationships.html#correct"><i class="fa fa-check"></i><b>6.9.1</b> Correct</a></li>
<li class="chapter" data-level="6.9.2" data-path="estimate-relationships.html"><a href="estimate-relationships.html#incorrect"><i class="fa fa-check"></i><b>6.9.2</b> Incorrect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="heterogeneous-treatment-effects.html"><a href="heterogeneous-treatment-effects.html"><i class="fa fa-check"></i><b>7</b> Heterogeneous Treatment Effects</a>
<ul>
<li class="chapter" data-level="7.1" data-path="learning-objectives-6.html"><a href="learning-objectives-6.html"><i class="fa fa-check"></i><b>7.1</b> Learning Objectives</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="treatment-noncompliance.html"><a href="treatment-noncompliance.html"><i class="fa fa-check"></i><b>8</b> Treatment Noncompliance</a>
<ul>
<li class="chapter" data-level="8.1" data-path="learning-objectives-7.html"><a href="learning-objectives-7.html"><i class="fa fa-check"></i><b>8.1</b> Learning Objectives</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="spillover-and-interference.html"><a href="spillover-and-interference.html"><i class="fa fa-check"></i><b>9</b> Spillover and Interference</a>
<ul>
<li class="chapter" data-level="9.1" data-path="learning-objectives-8.html"><a href="learning-objectives-8.html"><i class="fa fa-check"></i><b>9.1</b> Learning Objectives</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="causality-from-observational-data.html"><a href="causality-from-observational-data.html"><i class="fa fa-check"></i><b>10</b> Causality from Observational Data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="learning-objectives-9.html"><a href="learning-objectives-9.html"><i class="fa fa-check"></i><b>10.1</b> Learning Objectives</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="problems-and-diagnostics.html"><a href="problems-and-diagnostics.html"><i class="fa fa-check"></i><b>11</b> Problems and Diagnostics</a>
<ul>
<li class="chapter" data-level="11.1" data-path="learning-objectives-10.html"><a href="learning-objectives-10.html"><i class="fa fa-check"></i><b>11.1</b> Learning Objectives</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="attrition-mediation-and-generalizability.html"><a href="attrition-mediation-and-generalizability.html"><i class="fa fa-check"></i><b>12</b> Attrition, Mediation, and Generalizability</a>
<ul>
<li class="chapter" data-level="12.1" data-path="learning-objectives-11.html"><a href="learning-objectives-11.html"><i class="fa fa-check"></i><b>12.1</b> Learning Objectives</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="applications-of-experiments.html"><a href="applications-of-experiments.html"><i class="fa fa-check"></i><b>13</b> Applications of Experiments</a>
<ul>
<li class="chapter" data-level="13.1" data-path="learning-objectives-12.html"><a href="learning-objectives-12.html"><i class="fa fa-check"></i><b>13.1</b> Learning Objectives</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="review-of-the-course.html"><a href="review-of-the-course.html"><i class="fa fa-check"></i><b>14</b> Review of the Course</a>
<ul>
<li class="chapter" data-level="14.1" data-path="learning-objectives-13.html"><a href="learning-objectives-13.html"><i class="fa fa-check"></i><b>14.1</b> Learning Objectives</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Experiments and Causality</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulation-example" class="section level2" number="2.9">
<h2><span class="header-section-number">2.9</span> Simulation Example</h2>
<p>Now, let’s work through an example that shows this works not only in the math, but also in the realized, i.e. sampled, world.</p>
<p>To begin with, lets work with a <em>very</em> simple sample that has 100 observations, potential outcomes to control are uniformly distributed between <code>0</code> and <code>1</code> and every single unit has a potential outcome to treatment that is <code>0.25</code> units larger than their potential outcomes to control.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="simulation-example.html#cb5-1" aria-hidden="true" tabindex="-1"></a>make_simple_data <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">size=</span><span class="dv">100</span>) { </span>
<span id="cb5-2"><a href="simulation-example.html#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(data.table) </span>
<span id="cb5-3"><a href="simulation-example.html#cb5-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-4"><a href="simulation-example.html#cb5-4" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)  </span>
<span id="cb5-5"><a href="simulation-example.html#cb5-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-6"><a href="simulation-example.html#cb5-6" aria-hidden="true" tabindex="-1"></a>  d[ , y0 <span class="sc">:</span><span class="er">=</span> <span class="fu">runif</span>(.N, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>)]</span>
<span id="cb5-7"><a href="simulation-example.html#cb5-7" aria-hidden="true" tabindex="-1"></a>  d[ , y1 <span class="sc">:</span><span class="er">=</span> y0 <span class="sc">+</span> .<span class="dv">25</span>]</span>
<span id="cb5-8"><a href="simulation-example.html#cb5-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-9"><a href="simulation-example.html#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(d)</span>
<span id="cb5-10"><a href="simulation-example.html#cb5-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-11"><a href="simulation-example.html#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="simulation-example.html#cb5-12" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">make_simple_data</span>(<span class="at">size=</span><span class="dv">100</span>)</span>
<span id="cb5-13"><a href="simulation-example.html#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="simulation-example.html#cb5-14" aria-hidden="true" tabindex="-1"></a>d[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>##    id        y0        y1
## 1:  1 0.2036336 0.4536336
## 2:  2 0.5880883 0.8380883
## 3:  3 0.9905686 1.2405686
## 4:  4 0.6155806 0.8655806
## 5:  5 0.3893191 0.6393191</code></pre>
<p>In this world, we’ve taken a sample of <code>100</code> individuals, and at this point, each of those individuals that we’ve sampled has both a potential outcome to control <strong>and also</strong> a potential outcome to treatment. We haven’t talked at all about measurement yet; we’re just asserting that both of these potential outcomes exist for each person.</p>
<p>Essentially, this stage of creating the sample is the same as bringing people in the door to your experiment. If you were running this in the laboratory, you’d literally think of this as sitting your subjects down at their chairs, getting ready to begin their task.</p>
<blockquote>
<p>Is randomly sampling people to be a part of your experiment sufficient to ensure that your experiment produces an unbiaed, consistent estimate of the true treamtent effect?</p>
</blockquote>
<p>Suppose that for each unit, you then toss a coin, placing the subject either into treatment or control based on the result of that coin flip.</p>
<ul>
<li>Does this coin flip ensure that you have the same number of units in treatment as control? Does this matter to you? Why or why not?</li>
<li>Are there other ways that you could assign individuals to treatment an control, rather than through a simple-randomization process?</li>
<li>What are the relative merits or limitations of each of the methods?</li>
<li>Are some of these methods <em>more random</em> than others? Or, are all things that are random equal in their randomness?</li>
</ul>
<div id="assign-to-treatment-and-control" class="section level3" number="2.9.1">
<h3><span class="header-section-number">2.9.1</span> Assign to Treatment and Control</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="simulation-example.html#cb7-1" aria-hidden="true" tabindex="-1"></a>d[ , experimental_assignment <span class="sc">:</span><span class="er">=</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">size =</span> .N, <span class="at">replace =</span> <span class="cn">TRUE</span>)]</span>
<span id="cb7-2"><a href="simulation-example.html#cb7-2" aria-hidden="true" tabindex="-1"></a>d[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>##    id        y0        y1 experimental_assignment
## 1:  1 0.2036336 0.4536336                       0
## 2:  2 0.5880883 0.8380883                       0
## 3:  3 0.9905686 1.2405686                       0
## 4:  4 0.6155806 0.8655806                       1
## 5:  5 0.3893191 0.6393191                       1</code></pre>
<p>As as comparison, suppose that instead of randomly assigning individuals into treatment and control we allowed individuals to select into treatment and control. And suppose that people with the lowest potential outcomes to control opt to take the treatment. You might think of this as being something like, “The people who are the most tired are the most likely to drink a cup of coffee before they start class,” if an example helps you ground this.</p>
<p>Specifically, suppose that any unit that has a potential outcome lower that <code>0.33</code> opts to take the treatment.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="simulation-example.html#cb9-1" aria-hidden="true" tabindex="-1"></a>d[ , observational_selection <span class="sc">:</span><span class="er">=</span> <span class="fu">ifelse</span>(y0 <span class="sc">&lt;</span> .<span class="dv">33</span>, <span class="dv">1</span>, <span class="dv">0</span>)]</span>
<span id="cb9-2"><a href="simulation-example.html#cb9-2" aria-hidden="true" tabindex="-1"></a>d[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>##    id        y0        y1 experimental_assignment observational_selection
## 1:  1 0.2036336 0.4536336                       0                       1
## 2:  2 0.5880883 0.8380883                       0                       0
## 3:  3 0.9905686 1.2405686                       0                       0
## 4:  4 0.6155806 0.8655806                       1                       0
## 5:  5 0.3893191 0.6393191                       1                       0</code></pre>
<p>These represent two different ways that you might conduct your research, each time with the same subject pool. Of course, in reality you probably would not be able to run these two studies at the same time, but since this is a simulation, we can stretch the confines of reality just a little bit.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="simulation-example.html#cb11-1" aria-hidden="true" tabindex="-1"></a>first_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>d) <span class="sc">+</span> </span>
<span id="cb11-2"><a href="simulation-example.html#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> y0), <span class="at">color =</span> blue) <span class="sc">+</span> </span>
<span id="cb11-3"><a href="simulation-example.html#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> y1), <span class="at">color =</span> gold)</span>
<span id="cb11-4"><a href="simulation-example.html#cb11-4" aria-hidden="true" tabindex="-1"></a>first_plot  </span></code></pre></div>
<p><img src="241-livesession_files/figure-html/create%20first%20plot-1.png" width="672" /></p>
<p>What’s actually happening in this? It might be more clear if we add arrows to this plot to show.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="simulation-example.html#cb12-1" aria-hidden="true" tabindex="-1"></a>first_plot <span class="sc">+</span></span>
<span id="cb12-2"><a href="simulation-example.html#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb12-3"><a href="simulation-example.html#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">xend =</span> id, <span class="at">y =</span> y0, <span class="at">yend =</span> y1), </span>
<span id="cb12-4"><a href="simulation-example.html#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">ends =</span> <span class="st">&#39;last&#39;</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">&quot;inches&quot;</span>), <span class="at">type =</span> <span class="st">&#39;closed&#39;</span>), </span>
<span id="cb12-5"><a href="simulation-example.html#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&#39;grey70&#39;</span></span>
<span id="cb12-6"><a href="simulation-example.html#cb12-6" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<p><img src="241-livesession_files/figure-html/show%20the%20movement%20between%20potential%20outcomes-1.png" width="672" /></p>
<p>Even though these potential outcomes exist for all the units, is it possible to actually see them for all the units? How do we go about showing, and then measuring the potential outcomes to control for a set of units? How about the potential outcomes to treatment?</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="simulation-example.html#cb13-1" aria-hidden="true" tabindex="-1"></a>second_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> d) <span class="sc">+</span> </span>
<span id="cb13-2"><a href="simulation-example.html#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb13-3"><a href="simulation-example.html#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> y0, <span class="at">size =</span> <span class="dv">1</span> <span class="sc">-</span> experimental_assignment), </span>
<span id="cb13-4"><a href="simulation-example.html#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> blue) <span class="sc">+</span> </span>
<span id="cb13-5"><a href="simulation-example.html#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb13-6"><a href="simulation-example.html#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> y1, <span class="at">size =</span> <span class="dv">0</span> <span class="sc">+</span> experimental_assignment), </span>
<span id="cb13-7"><a href="simulation-example.html#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> gold) <span class="sc">+</span> </span>
<span id="cb13-8"><a href="simulation-example.html#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-9"><a href="simulation-example.html#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&#39;Treatment and Control Assignment&#39;</span>, </span>
<span id="cb13-10"><a href="simulation-example.html#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="st">&#39;Treatment or Control&#39;</span></span>
<span id="cb13-11"><a href="simulation-example.html#cb13-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-12"><a href="simulation-example.html#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="simulation-example.html#cb13-13" aria-hidden="true" tabindex="-1"></a>second_plot</span></code></pre></div>
<p><img src="241-livesession_files/figure-html/add%20points%20to%20plot-1.png" width="672" /></p>
<p>What are the averages of these samples that have been assigned to treatment?</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="simulation-example.html#cb14-1" aria-hidden="true" tabindex="-1"></a>third_plot <span class="ot">&lt;-</span> second_plot <span class="sc">+</span> </span>
<span id="cb14-2"><a href="simulation-example.html#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(</span>
<span id="cb14-3"><a href="simulation-example.html#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">yintercept =</span> <span class="fu">mean</span>(d[experimental_assignment<span class="sc">==</span><span class="dv">0</span>, y0]), </span>
<span id="cb14-4"><a href="simulation-example.html#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> blue, </span>
<span id="cb14-5"><a href="simulation-example.html#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb14-6"><a href="simulation-example.html#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(</span>
<span id="cb14-7"><a href="simulation-example.html#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">yintercept =</span> <span class="fu">mean</span>(d[experimental_assignment<span class="sc">==</span><span class="dv">1</span>, y1]), </span>
<span id="cb14-8"><a href="simulation-example.html#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> gold, </span>
<span id="cb14-9"><a href="simulation-example.html#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="dv">2</span>)</span>
<span id="cb14-10"><a href="simulation-example.html#cb14-10" aria-hidden="true" tabindex="-1"></a>third_plot</span></code></pre></div>
<p><img src="241-livesession_files/figure-html/add%20estimates%20from%20unbiased%20estimator-1.png" width="672" /></p>
<p>Even though we aren’t able to see it, can we reason about what the sample average would be if we could see both of an individual’s potential outcome to treatment and control?</p>
<ul>
<li>Is there a guarantee that the sample should be the same as the feasible realization?</li>
<li>Should they be close? What property from 203 provides this guarantee?</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="simulation-example.html#cb15-1" aria-hidden="true" tabindex="-1"></a>third_plot <span class="sc">+</span> </span>
<span id="cb15-2"><a href="simulation-example.html#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(d[, y0]), <span class="at">color =</span> blue, <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb15-3"><a href="simulation-example.html#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(d[, y1]), <span class="at">color =</span> gold, <span class="at">linetype =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="241-livesession_files/figure-html/add%20population%20expected%20values-1.png" width="672" /></p>
<p>Put it all together, what has this little demo shown?</p>
</div>
<div id="what-if-there-is-selection" class="section level3" number="2.9.2">
<h3><span class="header-section-number">2.9.2</span> What if there is selection?</h3>
<p>What if, rather than being assigned to treatment and control, instead individuals had been able to opt into treatment and control?</p>
<p>Produce only the last plot, but this time for the observational, or selected data.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="simulation-example.html#cb16-1" aria-hidden="true" tabindex="-1"></a>selection_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d) <span class="sc">+</span> </span>
<span id="cb16-2"><a href="simulation-example.html#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb16-3"><a href="simulation-example.html#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> y0, <span class="at">size =</span> <span class="dv">1</span> <span class="sc">-</span> observational_selection), </span>
<span id="cb16-4"><a href="simulation-example.html#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> blue) <span class="sc">+</span> </span>
<span id="cb16-5"><a href="simulation-example.html#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb16-6"><a href="simulation-example.html#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> y1, <span class="at">size =</span> <span class="dv">0</span> <span class="sc">+</span> observational_selection), <span class="at">color =</span> gold) <span class="sc">+</span> </span>
<span id="cb16-7"><a href="simulation-example.html#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(</span>
<span id="cb16-8"><a href="simulation-example.html#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">yintercept =</span> <span class="fu">mean</span>(d[, y0]), </span>
<span id="cb16-9"><a href="simulation-example.html#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> blue, </span>
<span id="cb16-10"><a href="simulation-example.html#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb16-11"><a href="simulation-example.html#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(</span>
<span id="cb16-12"><a href="simulation-example.html#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">yintercept =</span> d[observational_selection <span class="sc">==</span> <span class="dv">0</span>, <span class="fu">mean</span>(y0)], </span>
<span id="cb16-13"><a href="simulation-example.html#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> blue, </span>
<span id="cb16-14"><a href="simulation-example.html#cb16-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb16-15"><a href="simulation-example.html#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(</span>
<span id="cb16-16"><a href="simulation-example.html#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">yintercept =</span> <span class="fu">mean</span>(d[, y1]), </span>
<span id="cb16-17"><a href="simulation-example.html#cb16-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> gold, </span>
<span id="cb16-18"><a href="simulation-example.html#cb16-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb16-19"><a href="simulation-example.html#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(</span>
<span id="cb16-20"><a href="simulation-example.html#cb16-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">yintercept =</span> d[observational_selection <span class="sc">==</span> <span class="dv">1</span>, <span class="fu">mean</span>(y1)], </span>
<span id="cb16-21"><a href="simulation-example.html#cb16-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> gold, </span>
<span id="cb16-22"><a href="simulation-example.html#cb16-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb16-23"><a href="simulation-example.html#cb16-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-24"><a href="simulation-example.html#cb16-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&#39;Observational Selection into Treatment&#39;</span>, </span>
<span id="cb16-25"><a href="simulation-example.html#cb16-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="st">&#39;Treatment or Control&#39;</span></span>
<span id="cb16-26"><a href="simulation-example.html#cb16-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-27"><a href="simulation-example.html#cb16-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-28"><a href="simulation-example.html#cb16-28" aria-hidden="true" tabindex="-1"></a>selection_plot</span></code></pre></div>
<p><img src="241-livesession_files/figure-html/recreate%20plot%20--%20for%20selection%20case-1.png" width="672" /></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="theoretical-justification.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="requirements-of-an-experiment.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["241-livesession.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
